关于单片机上电时序：

**为什么RC复位电路的RC延时要按照3个RC来算**：

在 RC 复位电路中，通常认为经过 3 到 5 个 RC 时间常数后，电容充电或放电过程基本完成，并不是严格按照 3 个 RC 来算。

电容电压随时间的变化规律是按指数函数上升或下降的。

**单片机引脚放置下拉电阻要满足拉电流小于单片机规定的最大拉电流，比如20mA**

比如放置一个4.7k的电阻，那么拉电流大概为0.65mA。

**常识**

单片机连接器插拔要在断电的情况下进行。

**ADC测量常识**

ADC测量在量程的1/3 ~ 2/3之间精度时最高的。

应用：比如两个1%精度10K的电阻分压3.3V，当ADC电阻上测得电压为1.5V时，乘以2倍就得到实际电压。

**检流电阻**

检流电阻为毫欧级别，不能影响电源输出。检流电阻伴随着放大器输入到单片机的ADC检测端口。比如经过放大器以后的电压为0.2V对应2A。

**温度传感器DS18B20**

比如监控FPGA、电源芯片、AD/DA模块。

DS18B20是1wire数字温度计。每颗芯片具有唯一的设备ID，那么就可以将多个DS18B20连接到同一个控制器的引脚上。

**什么时候芯片的引脚要接上拉电阻**

当引脚是开漏的时候，要接上拉电阻。因为开漏只能确定低电平的状态，高电平状态需要借助上拉电阻到VCC。

**给芯片提供电源的数字电源**

比如有几个管脚需要3.3V_MCU就需要几个小电容（比如0.1uF）,如果布局空间有限，那么两个管脚共用一个电容也可以。

**什么时候用磁珠作为隔离电路**

当电路为射频、AD（高频）、震荡等等电路要用磁珠隔离，磁珠可以吸收高频振荡噪声。

电感是将噪声反射回去，电容是提供一个泄放通路（高频情况下）。

用电感的情况：低频电路，降低线路传导干扰。

那么**总结**：模拟电路和数字电路的隔离要用磁珠，为了让模拟电源更干净。

**关于JTAG调试接口**、

比如STM32系列芯片，其内部已经设置了JTAG的上下拉。但如果要自己设置上下拉，根据JTAG的协议，时钟信号要下拉，其他都上拉。

**时钟电路的设计**

1、反馈电阻的大小；

​	如果芯片内部有反馈电阻，外部可以不加。但是一般不管内部有没有反馈电阻都在外部加上反馈电阻，这样电路就成为了一个通用的电路，如果芯片内部有外部就不焊接了，没有就焊接。

​	芯片内部有个反向器接到了晶振两端，比如晶振起始为高，经过反向器变为低信号再输入到晶振，如此反复形成震荡。

<img src="C:\Users\Lihui\AppData\Roaming\Typora\typora-user-images\image-20250513165137599.png" alt="image-20250513165137599" style="zoom:50%;" />

2、匹配电容的大小。

​	选择的匹配电容的大小应该为晶振的负载匹配电容的1.2~1.5倍。之所以要比晶振的负载匹配电容打一下，是因为线路上有寄生电容存在（一般为3~5pF）。

如果想实际频率很精确的话，将晶振的输出引脚通过测试夹具或探头与频率计的输入端口相连，再根据测得的频率调整电容的大小。

套用公式：<img src="C:\Users\Lihui\AppData\Roaming\Typora\typora-user-images\image-20250513165830692.png" alt="image-20250513165830692" style="zoom:25%;" />

**PCB设计注意事项**

<img src="C:\Users\Lihui\AppData\Roaming\Typora\typora-user-images\image-20250513172507876.png" alt="image-20250513172507876" style="zoom:50%;" />



**复位电路**

1、RC复位电路，RC的取值要满足芯片的最小复位时间要求。

2、看门狗复位电路。

**接口电路隔离**

<img src="C:\Users\Lihui\AppData\Roaming\Typora\typora-user-images\image-20250514102053321.png" alt="image-20250514102053321" style="zoom:50%;" />

1、为什么外壳地和信号地之间隔了一个耐压2000V的小电容：

​	如果外壳地有干扰，电容会阻止干扰信号到信号地。

2、为什么放一个1M的电阻：

​	如果板子内部有静电积累，可以通过这个电阻逐渐通过外壳地释放到大地。

也就是要隔离但又不能完全隔离断，这就是要放1M电阻的原因。

**电源保险丝选型**

打6~7折的降额，比如板卡工作最大30W/5V，那么就需要6A的电流。6/0.7 = 8.5，也就是需要选择接近8.5A的保险丝，比如10A。

保险丝的熔断与流经它的电流有关系，从保险丝使用方面规定了最大电压，使用环境不能超过此电压，否则会破坏保险丝的电器性能。

**TVS的选型**

TVS的反向截止电压（TVS工作电压）应稍微大于要保护的器件的正常工作电压，比如器件正常工作电压为12V，那么TVS可以选择13V的。

TVS的反向截止电压标志TVS管不导通的最大电压，在这个电压下只有很小的反向漏电流。

**T型滤波器**

原理：利用电感通低频、阻高频，电容通高频阻低频的特性。对于特定信号，电感和电容协同作用，使需要的频率信号顺利通过，抑制不需要的频率信号。比如在低通T型滤波器中，低频信号可相对容易通过，高频信号则被电感和电容阻碍。



**板卡电源电流检测设计**

1、用专用的电流取样电阻。

2、使用专用的电流采集芯片：

​	INA168：2.7V~60V，输入（即取样电阻两端的电压）满量程为100mV以内。

最后INA168的测量输出最好将其放大到3.3 * 1/3 ~ 3.3 * 2/3 之间。